---
layout: post
title: the fault in our shells : sebuah tinjauan menjalankan cowrie
date: 2019-02-02 12:33
author: admin
comments: true
categories: [forensic, internet, security]
---
<p style="text-align: justify;">Penulis menjalankan <a href="https://github.com/cowrie/cowrie">cowrie</a> (ssh honeypot) pada sebuah VPS berlokasi di Singapura selama 7 hari. Pengiriman log, analisis dan visualisasi dilakukan dengan menggunakan ELK <em>stack </em> dan Tableau Visualiser. Selain itu, Penulis juga melakukan analisis atas <em>auth.log</em> milik VPS dimaksud.</p>
<p style="text-align: justify;">Serangan pertama atas <em>honeypot </em>yang dijalankan penulis terjadi hanya dalam 5 menit sejak <em>service </em>cowrie aktif. Secara total terdapat 22.250 kali percobaan login selama 7 hari atau hampir 2 kali percobaan login tiap detik. Selain itu terdapat 510.659 perintah yang dieksekusi oleh penyerang yang telah berhasil login selama 7 hari, atau lebih dari 50 perintah per menit.</p>
<img class="aligncenter" src="http://aldosimon.com/blog/wp-content/uploads//2019/02/ip-uname-password-1.png" />
<p style="text-align: justify;">Gambar di atas memperlihatkan <em>top 10 ip address, username,</em> dan <em>password</em> yang digunakan oleh penyerang.</p>
<p style="text-align: justify;">Percobaan login terbanyak berasal dari IP address 198.98.62.xxx, sedangkan percobaan login kedua terbanyak berasal dari IP address 194.36.173.xxx. Menariknya, percobaan login dari kedua IP address tersebut melingkupi hampir 50% dari seluruh total percobaan login (47,33%). Berdasarkan <em>payload </em>yang terdapat (dan diunduh) di C2 <em>server </em>masing-masing IP <em>address</em>, diperoleh informasi bahwa IP address pertama merupakan botnet Mirai sedangkan IP address kedua merupakan botnet Bushido.</p>
<p style="text-align: justify;"><em>Top 10 Username</em> memiliki beberapa username yang sama dan digunakan oleh beberapa penyerang. <em>Username </em>yang lazim ditemukan dalam <em>dictionary/wordlist, </em>seperti “root”, “admin”, “guest”, menempati posisi-posisi awal. Selain itu terlihat beberapa <em>username </em>yang khusus menyasar consumer IoT devices seperti “vstarcam2015” yang merupakan <em>username default </em>IP camera Vstarcam dan “ubnt” yang merupakan <em>username default </em>network device milik vendor Ubiquiti.</p>
<p style="text-align: justify;">Selain <em>username </em>yang lazim digunakan dan <em>username </em>yang khusus menyasar <em>default login </em>device/IoT tertentu, muncul pula <em>username </em>yang cukup berbeda dari dua jenis <em>username </em>tersebut. <em>Username </em>tersebut antara lain “enable”, “shell”.</p>
<p style="text-align: justify;"><em>Top 10 Password</em> memiliki hasil yang lebih merata dibandingkan dengan Top 10 <em>username.</em> Serupa dengan Top 10 <em>username, password </em>yang seringkali menjadi <em>password </em>default dan sudah umum di berbagai <em>dictionary</em>/<em>wordlist,</em> muncul di urutan yang cukup tinggi, antara lain <em>password </em> seperti “12345”, “123456”, “1111”, “password”. Selain itu terdapat juga beberapa password yang menyasar <em>device </em>tertentu seperti xc3511 (menyasar H.264 Chinese DVR).</p>
<p style="text-align: justify;">Serupa dengan username, terdapat beberapa <em>password </em>yang tidak umum digunakan dalam <em>wordlist brute force</em> namun kerap kali muncul dengan urutan cukup tinggi sebagai <em>password </em>yang digunakan. <em>Password </em>ini antara lain “system”, “sh”.</p>
<p style="text-align: left;"><strong><em><span style="text-decoration: underline;">Session dan command</span></em></strong></p>
<p style="text-align: justify;">Sebuah session adalah sebuah perintah login yang berhasil, dimana penyerang kemudian dapat memasukkan perintah. Terdapat 20.576 percobaan <em>login </em>yang berhasil, dari total 22.250 kali percobaan login. Setelah mendapatkan <em>session, </em>terdapat beberapa perintah yang dijalankan berbagai <em>malware</em>, yang secara umum dapat digambarkan sebagai berikut<em>.</em></p>
<p style="text-align: justify;"><em><strong><span style="text-decoration: underline;">Fingerprinting dan persiapan</span></strong></em></p>
<p style="text-align: justify;">Terdapat beberapa perintah-perintah yang bertujuan untuk melakukan <em>fingerprinting </em>dan persiapan, antara lain:</p>

<ol style="list-style-type: lower-alpha;">
 	<li style="text-align: justify;">enable/system/shell/sh : seperti dibahas sebelumnya, perintah ini bertujuan mengaktifkan shell dan masuk ke dalam shell, apabila diperlukan.</li>
 	<li style="text-align: justify;">/bin/busybox [TOKEN]<a href="#_ftn1" name="_ftnref1"><sup>[1]</sup></a> : Perintah ini menggunakan busybox untuk menjalankan [TOKEN]. [TOKEN] sendiri adalah kumpulan karakter (bersifat random maupun tidak). Terdapat beberapa jenis [TOKEN] yang berbeda-beda, beberapa yang umum ditemui adalah ECCHI, BUSHIDO, FAGT, iDdosYou, MIRAI, MIORI, YAGI, OWARI, IHCCE dan beberapa yang <em>random </em>mengingat jenisnya sangat beragam. Token ini memiliki dua fungsi, mengetahui bahwa sebuah perintah selesai dijalankan, ketika terminal menjawab dengan <em>[TOKEN]: applet not found</em>. Sehingga perintah dengan token ini biasanya diletakan di bagian akhir perintah. Selain itu perintah dengan token ini juga dapat digunakan untuk <em>fingerprinting operating system </em>yang berjalan dengan melihat <em>error </em>yang dikembalikan OS.</li>
 	<li style="text-align: justify;">echo: Terdapat beberapa jenis perintah yang berbeda-beda dengan tujuan serupa, yaitu mengecek di folder mana yang bisa ditulis (<em>writable</em>). Perintah <em>echo </em>di dahului dengan mengecek <em>mounted folder </em>dan mengecek apakah <em>mounted folder </em>tadi <em>writable </em>dilakukan dengan Token dengan <em>random value </em>(“DT86VkNA”) juga muncul disini, dengan tujuan mengecek apakah perintah mengecek <em>mounted folder </em>yang dijalankan telah selesai.</li>
 	<li style="text-align: justify;">Pengecekan <em>environment: </em>berbagai perintah mengecek <em>environment </em>dimana <em>malware </em>tersebut dijalankan. Perintah-perintah tersebut cukup umum, antara lain “free”, “uname”, “ifconfig”, “ping”, dan lainnya. Keberadaan aplikasi transfer file juga di-cek, antara lain dengan menjalankan “wget” dan “tftp”.</li>
</ol>
<p style="text-align: justify;"><span style="text-decoration: underline;"><strong><em>Contacting C2 </em>server <em>/ downloading payload</em></strong></span></p>
<p style="text-align: justify;">Setelah perintah <em>fingerprinting </em>dan persiapan lainnya, <em>malware </em>yang ditemui penulis, selama periode 7 hari, berusaha melakukan kontak ke Command and Control server (C2 server), atau melakukan <em>download payload</em>. Perintah ini biasanya didahului dengan mengecek apakah terdapat aplikasi transfer file, dan kemudian melakukan pengunduhan <em>payload.</em></p>
<p style="text-align: justify;"><em><span style="text-decoration: underline;"><strong>Perintah lain</strong></span></em></p>
<p style="text-align: justify;">Beberapa <em>malware </em>menjalankan perintah untuk mengecek <em>process </em>yang berjalan, mencari proses tertentu (dalam hal ini <em>miner</em>), serta terdapat juga <em>malware </em>yang berusaha membersihkan jejak dengan mematikan pencatatan history.</p>
<em><span style="text-decoration: underline;"><strong>Downloaded files</strong></span></em>
<p style="text-align: justify;">Dari sebanyak 10.874 <em>download request </em>(menggunakan wget, ftpget, tftp) terdapat 43 jenis <em>payload </em>yang unik. Terdiri dari 5 buah <em>script</em> bash, 1 buah <em>script </em>perl dan sisanya merupakan linux <em>executables</em>.</p>
<p style="text-align: justify;"><strong><em>Post ini merupakan summary dari tulisan penulis di e-magazine cyber defense community indonesia (cdef) 4th edition yang bisa di-unduh dari playstore/website cdef.</em></strong><span style="text-decoration: underline;"><strong>
</strong></span></p>
link playstore: <a href="https://play.google.com/store/books/details?id=ond7DwAAQBAJ">https://play.google.com/store/books/details?id=ond7DwAAQBAJ</a>

link pdf: <a href="https://s.id/cdefbulletin04">https://s.id/cdefbulletin04</a>
<p style="text-align: justify;"><a href="#_ftnref1" name="_ftn1"><sup>[1]</sup></a> Serupa dengan mirai, beberapa token seperti ECCHI, YAGI, OWARI tampaknya berasal dari serial Anime. Selain itu ditemukan token-token unik lainnya seperti “IDdosYou”, “daddyl33t”, “mioribitches” dan lain-lain, walaupun sebagian besar token terlihat adalah random.</p>
